ç¬¬20ç«  javascript API

æœ¬ç« å†…å®¹
Â·Atomicsä¸SharedArrayBuffer
Â·è·¨ä¸Šä¸‹æ–‡æ¶ˆæ¯
Â·Encoding API
Â·File APIä¸Blob API
Â·æ‹–æ”¾
Â·Notifications API
Â·Page Visibility API
Â·Streams API
Â·è®¡æ—¶API
Â·Webç»„ä»¶
Â·Web Cryptography API

20.1 Atomics ä¸ SharedArrayBuffer

Atomics APIé€šè¿‡å¼ºåˆ¶åŒä¸€æ—¶åˆ»åªèƒ½å¯¹ç¼“å†²åŒºæ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œå¯ä»¥è®©å¤šä¸ªä¸Šä¸‹æ–‡å®‰å…¨åœ°è¯»å†™ä¸€ä¸ªSharedArrayBuffer.

SharedArrayBuffer ä¸ SharedArrayBufferå…·æœ‰åŒæ ·çš„APIã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯ArrayBufferå¿…é¡»åœ¨ä¸åŒ
æ‰§è¡Œä¸Šä¸‹æ–‡é—´åˆ‡æ¢ï¼ŒsharedArrayBufferåˆ™å¯ä»¥è¢«ä»»æ„å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡åŒæ—¶ä½¿ç”¨ã€‚


20.2 è·¨ä¸Šä¸‹æ–‡æ¶ˆæ¯   XDMï¼ˆcross-document messagingï¼‰

æ˜¯ä¸€ç§åœ¨ä¸åŒæ‰§è¡Œä¸Šä¸‹æ–‡é—´ä¼ é€’æ¶ˆæ¯çš„èƒ½åŠ›ã€‚å¦‚www.wrox.comä¸Šçš„é¡µé¢æƒ³è¦ä¸åŒ…å«åœ¨å†…åµŒçª—æ ¼ä¸­çš„p2p.wrox.com
ä¸Šä¸Šé¢çš„é¡µé¢é€šä¿¡ã€‚åœ¨XDMä¹‹å‰ï¼Œè¦ä»¥å®‰å…¨æ–¹å¼å®ç°è¿™ç§é€šä¿¡éœ€è¦å¾ˆå¤šå·¥ä½œã€‚XDMä»¥å®‰å…¨ä»¥ç”¨çš„æ–¹å¼è§„èŒƒåŒ–äº†è¿™ä¸ªåŠŸèƒ½

æ³¨æ„ï¼šè·¨ä¸Šä¸‹æ–‡å‘¢æ¶ˆæ¯ç”¨äºçª—å£ä¹‹é—´é€šä¿¡æˆ–å·¥ä½œç°åœºä¹‹é—´é€šä¿¡ã€‚æœ¬èŠ‚ä¸»è¦ä»‹ç»ä½¿ç”¨postMessage()ä¸å…¶ä»–çª—å£
é€šä¿¡ã€‚


XDMçš„æ ¸å¿ƒæ˜¯postMessage()æ–¹æ³•ã€‚å¤„ç†XDMï¼Œè¿™ä¸ªæ–¹æ³•åæ¢åœ¨HTML5ä¸­å¾ˆå¤šåœ°æ–¹ç”¨åˆ°è¿‡ï¼Œä½†ç›®çš„éƒ½ä¸€æ ·ï¼Œéƒ½æ˜¯æŠŠ
æ•°æ®ä¼ é€åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚

postMessage()æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š
1.æ¶ˆæ¯ã€
2.è¡¨ç¤ºç›®æ ‡æ¥æ”¶æºçš„å­—ç¬¦ä¸²
3.å¯é€‰çš„å¯ä¼ è¾“å¯¹è±¡çš„æ•°ç»„ï¼ˆåªä¸å·¥ä½œçº¿ç¨‹ç›¸å…³ï¼‰

let iframeWindow = document.getElementById('myframe').contentWindow;
iframeWindow.postMessage('A secret', 'http://www.wrox.com')

æœ€åä¸€è¡Œä»£ç å°è¯•å‘å†…åµŒçª—æ ¼ä¸­å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œè€Œä¸”æŒ‡å®šäº†æºå¿…é¡»æ˜¯'http://www.wrox.com'ã€‚å¦‚æœè·ŸæºåŒ¹é…ï¼Œ
é‚£ä¹ˆæ¶ˆæ¯å°†ä¼šè¾ƒå¤åˆ°å†…åµŒçª—æ ¼ï¼›å¦åˆ™ï¼ŒpostMessage()ä»€ä¹ˆä¹Ÿä¸åšã€‚è¿™ä¸ªé™åˆ¶å¯ä»¥ä¿æŠ¤ä¿¡æ¯ä¸ä¼šå› åœ°å€æ”¹å˜è€Œ
æ³„æ¼ã€‚å¦‚æœä¸æƒ³é™åˆ¶æ¥æ”¶ç›®æ ‡ï¼Œåˆ™å¯ä»¥ç»™postMessage()çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ "*"ï¼Œä½†ä¸æ¨èè¿™ä¹ˆåšã€‚

æ¥æ”¶åˆ°XDMæ¶ˆæ¯åï¼Œwindowå¯¹è±¡ä¸Šä¼šè§¦å‘messageäº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶æ˜¯å¼‚æ­¥è§¦å‘çš„ï¼Œå› æ­¤ä»æ¶ˆæ¯å‘é€åˆ°æ¥æ”¶åˆ°æ¶ˆæ¯
ï¼ˆæ¥æ”¶çª—å£è§¦å‘messageäº‹ä»¶ï¼‰å¯èƒ½æœ‰å»¶è¿Ÿã€‚ä¼ ç»™onmessageäº‹ä»¶å¤„ç†ç¨‹åºçš„eventå¯¹è±¡åŒ…å«ä»¥ä¸‹3æ–¹é¢é‡è¦ä¿¡æ¯ã€‚
Â·dataï¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™postMessageï¼ˆï¼‰çš„å­—ç¬¦ä¸²æ•°æ®
Â·originï¼šå‘é€æ¶ˆæ¯çš„æ–‡æ¡£æºï¼Œå¦‚â€œhttp://www.wrox.comâ€
Â·source:å‘é€æ¶ˆæ¯çš„æ–‡æ¡£ä¸­windowå¯¹è±¡çš„ä»£ç†ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡ä¸»è¦ç”¨äºåœ¨å‘é€ä¸Šä¸€æ¡æ¶ˆæ¯çš„çª—å£ä¸­æ‰§è¡ŒpostMesage
æ–¹æ³•ã€‚å¦‚æœè·Ÿå‘é€çª—å£æœ‰ç›¸åŒçš„æºï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡åº”è¯¥å°±æ˜¯windowå¯¹è±¡ã€‚

æ¥æ”¶æ¶ˆæ¯ä¹‹åéªŒè¯å‘é€çª—å£çš„æºæ˜¯éå¸¸é‡è¦çš„ã€‚ä¸postMessage()çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥åŒ…è£…æ•°æ®ä¸ä¼šæ„ä¼ ç»™æœªçŸ¥
é¡µé¢ä»¥ç”¨ï¼Œåœ¨onmessageäº‹ä»¶å¤„ç†ç¨‹åºä¸­æ£€æŸ¥å‘é€çª—å£çš„æºå¯ä»¥åŒ…è£…æ•°æ®æ¥è‡ªçœŸç¡®çš„åœ°æ–¹

window.addEventListener('message', event => {
  if(event.origin == 'http://www.wrox.com'){
    //æ•°æ®å¤„ç†
    processMessage(event.data)

    //å‘æ¥æºçª—å£å‘é€ä¸€æ¡æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰
    event.source.postMessage('Received!', 'http://p2p.wrox.com')
  }
})

20.3 Encoding API

ä¸»è¦ç”¨äºå®ç°å­—ç¬¦ä¸²ä¸å®šå‹æ•°ç»„ä¹‹é—´çš„è½¬æ¢ã€‚è§„èŒƒæ–°å¢äº†4ä¸ªç”¨äºæ‰§è¡Œè½¬æ¢çš„å…¨å±€ç±»ï¼š
TextEncoder
TextEncoderStream
TextDecoder
TextDecoderStream

20.3.1 æ–‡æœ¬ç¼–ç 

Encoding APIæä¾›äº†ä¸¤ç§é—´å­—ç¬¦ä¸²è½¬æ¢ä¸ºå®šå‹æ•°ç»„äºŒè¿›åˆ¶æ ¼å¼çš„æ–¹æ³•ï¼šæ‰¹é‡ç¼–ç å’Œæµç¼–ç ï¼Œè½¬æ¢æ—¶ï¼Œç¼–ç å™¨
å§‹ç»ˆä½¿ç”¨UTF-8

1.æ‰¹é‡ç¼–ç 

æ‰€è°“æ‰¹é‡ï¼ŒæŒ‡çš„æ˜¯jså¼•æ“ä¼šåŒæ­¥ç¼–ç æ•´ä¸ªå­—ç¬¦ä¸²ã€‚å¯¹äºéå¸¸é•¿å¾—å­—ç¬¦ä¸²ï¼Œå¯èƒ½ä¼šèŠ±è¾ƒé•¿æ—¶é—´ã€‚
æ‰¹é‡ç¼–ç æ˜¯é€šè¿‡TextEncoderå¾—å®ä¾‹å®Œæˆçš„ï¼š

const textEncoder = new TextEncoder()

encode()ï¼Œæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¹¶ä»¥Unit8Arrayæ ¼å¼è¿”å›æ¯ä¸ªå­—ç¬¦ä¸²çš„UTF-8ç¼–ç 

const textEncoder = new TextEncoder();
const decodedText = 'foo'
const encodedText = textEncoder.encode(decodedText)
console.log(encodedText)
//Uint8Array(3)Â [102, 111, 111]

æœ‰äº›å­—ç¬¦å å¤šä¸ªç´¢å¼•ï¼Œå¦‚ğŸ˜€

encodeInto()æ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å’Œç›®æ ‡Unit8Arrayï¼Œè¿”å›ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«readå’Œwrittenå±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤º
æˆåŠŸä»æºå­—ç¬¦ä¸²è¯»å–äº†å¤šå°‘å­—ç¬¦å’Œå‘ç›®æ ‡æ•°ç»„å†™å…¥äº†å¤šå°‘å­—ç¬¦ã€‚

const textEncoder = new TextEncoder();
const fooArr = new Uint8Array(3)
const barArr = new Uint8Array(2)

const fooResult = textEncoder.encodeInto('foo', fooArr)
const barResult = textEncoder.encodeInto('bar', barArr)

console.log(fooResult, fooArr)  //{read: 3, written: 3} Uint8Array(3)Â [102, 111, 111]
console.log(barResult, barArr)  //{read: 2, written: 2} Uint8Array(2)Â [98, 97]

æ³¨æ„ï¼šæ–‡æœ¬ç¼–ç ä¼šå§‹ç»ˆä½¿ç”¨UTF-8æ ¼å¼ï¼Œè€Œä¸”å¿…é¡»å†™å…¥Unit8Arrayå®ä¾‹ã€‚ä½¿ç”¨å…¶ä»–ç±»å‹æ•°ç»„ä¼šå¯¼è‡´encodeInto()
æŠ›å‡ºé”™è¯¯ã€‚

2.æµç¼–ç 

TextEncoderStreamå…¶å®å°±æ˜¯TransformStreamå½¢å¼çš„TextEncoderã€‚å°†è§£ç åçš„æ–‡æœ¬æµé€šè¿‡ç®¡é“è¾“å…¥æµç¼–ç 
ä¼šå¾—åˆ°ç¼–ç åæ–‡æœ¬å—çš„æµï¼š

async function* chars(){
  const decodedText = 'foo'
  for( let char of decodedText){
    yield await new Promise(resolve => setTimeout(resolve, 1000, char))
  }
}

const decodedTextStream = new ReadableStream({
  async start(controller){
    for await (let chunk of chars()) {
      controller.enqueue(chunk);
    }
    controller.close();
  }
})

const encodedTextStream = decodedTextStream.pipeThrough(new TextEncoderStream())

const readableStreamDefaultReader = encodedTextStream.getReader();

(async function(){
  while(true){
    const { done, value } = await readableStreamDefaultReader.read();

    if(done){
      break;
    }else{
      console.log(value)
    }
  }
})();

//Uint8ArrayÂ [102]
//Uint8ArrayÂ [111]
//Uint8ArrayÂ [111]

20.3.2 æ–‡æœ¬è§£ç 
Encoding API æä¾›äº†ä¸¤ç§å°†å®šå‹æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼šæ‰¹é‡è§£ç å’Œæµè§£ç 

1.æ‰¹é‡è§£ç 

æŒ‡çš„æ˜¯jså¼•æ“ä¼šåŒæ­¥è§£ç  æ•´ä¸ªå­—ç¬¦ä¸²
const textDecoder = new TextDecoder();


const textDecoder = new TextDecoder();
const encodedText = Uint8Array.of(102, 111, 111)
const decodedText = textDecoder.decode(encodedText)
console.log(decodedText)
//foo

è§£ç å™¨ä¸å…³å¿ƒä¼ å…¥çš„æ˜¯å“ªç§å®šå‹æ•°ç»„ï¼Œä»–åªä¼šä¸“å¿ƒè§£ç æ•´ä¸ªäºŒè¿›åˆ¶è¡¨ç¤ºã€‚

const textDecoder = new TextDecoder()
const encodedText = Uint32Array.of(102, 111, 111)
const decodedText = textDecoder.decode(encodedText)
console.log(decodedText)
//"f   o   o   "

ä¸TextEncoderä¸åŒï¼ŒTextDecoderå¯ä»¥å…¼å®¹å¾ˆå¤šå­—ç¬¦ç¼–ç ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°±æ˜¯ä½¿ç”¨äº†UTF-16

const textDecoder = new TextDecoder('utf-16')
const encodedText = Uint16Array.of(102, 111, 111)
const decodedText = textDecoder.decode(encodedText)
console.log(decodedText)
//foo

2.è§£ç æµ

20.4 File API ä¸ Blob API

file API ä¸ Blob API æ˜¯ä¸ºäº†è®©webå¼€å‘è€…èƒ½ä»¥å®‰å…¨çš„æ–¹å¼è®¿é—®å®¢æˆ·ç«¯æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»è€Œæ›´å¥½åœ°ä¸è¿™äº›æ–‡ä»¶
äº¤äº’è€Œè®¾è®¡çš„ã€‚

20.4.1 Fileç±»å‹

File APIä»ç„¶ä»¥è¡¨å•ä¸­çš„æ–‡ä»¶è¾“å…¥å­—æ®µä¸ºåŸºç¡€ï¼Œä½†æ˜¯å¢åŠ äº†ç›´æ¥è®¿é—®æ–‡ä»¶ä¿¡æ¯çš„èƒ½åŠ›ã€‚HTML5åœ¨domä¸Šä¸ºæ–‡ä»¶
è¾“å…¥å…ƒç´ æ·»åŠ äº†filesé›†åˆã€‚å½“ç”¨æˆ·åœ¨æ–‡ä»¶å­—æ®µä¸­é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªfilesé›†åˆä¼šåŒ…å«ä¸€ç»„Fileå¯¹è±¡ï¼Œ
è¡¨ç¤ºè¢«é€‰ä¸­çš„æ–‡ä»¶ã€‚æ¯ä¸ªFileå¯¹è±¡éƒ½æœ‰ä¸€äº›åªè¯»å±æ€§ã€‚
Â·nameï¼šæœ¬åœ°ç³»ç»Ÿä¸­çš„æ–‡ä»¶å
Â·sizeï¼šä»¥å­—èŠ‚è®¡çš„æ–‡ä»¶å¤§å°
Â·typeï¼šåŒ…å«æ–‡ä»¶MIMEç±»å‹çš„å­—ç¬¦ä¸²
Â·lastModifiedDateï¼šè¡¨ç¤ºæ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´çš„å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå±æ€§åªæœ‰Chromeå®ç°äº†ã€‚

ä¾‹ï¼š
let filesList = document.getElementById('files-list')
filesList.addEventListener('change', event => {
  let files = event.target.files,
      i = 0,
      len = files.length;

  while(i < len){
    const f = files[i]
    console.log(`${f.name} (${f.type}, ${f.size} bytes)`);
    i++;
  }
})


ä¸è¿‡ï¼Œfile APIè¿˜æä¾›äº†FileReaderç±»å‹ï¼Œè®©æˆ‘ä»¬å¯ä»¥å®é™…ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚

20.4.2 FileReader ç±»å‹

FileReaderç±»å‹è¡¨ç¤ºä¸€ç§å¼‚æ­¥æ–‡ä»¶è¯»å–æœºåˆ¶ã€‚å¯ä»¥æŠŠFileReaderæƒ³è±¡æˆç±»ä¼¼äºXMLHttpRequestï¼Œåªä¸è¿‡
æ˜¯ç”¨äºä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä»æœåŠ¡å™¨è¯»å–æ•°æ®ã€‚FileReaderç±»å‹æä¾›äº†å‡ ç§è¯»å–æ–‡ä»¶æ•°æ®çš„æ–¹æ³•ã€‚

Â·readAsText(file, encoding)ï¼šä»æ–‡ä»¶ä¸­è¯»å–çº¯æ–‡æœ¬å†…å®¹å¹¶ä¿å­˜åœ¨resultå±æ€§ä¸­ã€‚
Â·readAsDataURL(file)ï¼šè¯»å–æ–‡ä»¶å¹¶å°†å†…å®¹çš„æ•°æ®URIä¿å­˜åœ¨resultå±æ€§ä¸­ã€‚
Â·readAsBinaryString(file)ï¼šè¯»å–æ–‡ä»¶å¹¶å°†æ¯ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åœ¨resultå±æ€§ä¸­ã€‚
Â·readAsArrayBuffer(file)ï¼šè¯»å–æ–‡ä»¶å¹¶å°†æ–‡ä»¶å†…å®¹ä»¥ArrayBufferå½¢å¼ä¿å­˜åœ¨resultå±æ€§ã€‚

è¿™äº›è¯»å–æ•°æ®çš„æ–¹å¼ä¸ºå¤„ç†æ–‡ä»¶æ•°æ®æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚å¦‚ï¼Œä¸ºäº†å‘ç”¨æˆ·å±•ç¤ºå›¾ç‰‡ï¼Œå¯ä»¥å°†å›¾ç‰‡è¯»å–ä¸ºæ•°æ®
URIï¼Œè€Œä¸ºäº†è§£ææ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥å°†æ–‡ä»¶è¯»å–ä¸ºæ–‡æœ¬ã€‚

å› ä¸ºè¿™äº›æ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æ¯ä¸ªFileReaderä¼šå‘å¸ƒå‡ ä¸ªäº‹ä»¶ï¼Œå…¶ä¸­3ä¸ªæœ€æœ‰ç”¨çš„äº‹ä»¶æ˜¯ï¼š
progressã€errorå’Œloadï¼Œåˆ†åˆ«è¡¨ç¤ºè¿˜æœ‰æ›´å¤šæ•°æ®ã€å‘ç”Ÿäº†é”™è¯¯å’Œè¯»å–å®Œæˆã€‚

progressäº‹ä»¶æ¯50æ¯«ç§’å°±ä¼šè§¦å‘ä¸€æ¬¡ï¼Œå…¶ä¸XHRçš„progressäº‹ä»¶å…·æœ‰ç›¸åŒçš„ä¿¡æ¯ï¼šlengthComputableã€
loadedå’Œtotalã€‚æ­¤å¤–ï¼Œåœ¨progressäº‹ä»¶ä¸­å¯ä»¥è¯»å–FileReaderçš„resultå±æ€§ï¼Œå³ä½¿å…¶ä¸­å°šæœªåŒ…å«å…¨éƒ¨æ•°æ®ã€‚

erroräº‹ä»¶ä¼šåœ¨ç”±äºæŸç§åŸå› æ— æ³•è¯»å–æ–‡ä»¶æ—¶è§¦å‘ã€‚è§¦å‘erroräº‹ä»¶æ—¶ï¼ŒFileReaderçš„errorä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ã€‚
è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåªåŒ…å«ä¸€ä¸ªå±æ€§ï¼šcodeã€‚è¿™ä¸ªé”™è¯¯ç çš„å€¼å¯èƒ½æ˜¯1ï¼ˆæœªæ‰¾åˆ°æ–‡ä»¶ï¼‰ã€2ï¼ˆå®‰å…¨é”™è¯¯ï¼‰ã€
3ï¼ˆè¯»å–è¢«ä¸­æ–­ï¼‰ã€4ï¼ˆæ–‡ä»¶ä¸å¯è¯»ï¼‰æˆ–5ï¼ˆç¼–ç é”™è¯¯ï¼‰ã€‚

loadäº‹ä»¶ä¼šåœ¨æ–‡ä»¶æˆåŠŸåŠ è½½åè§¦å‘ã€‚å¦‚æœerroräº‹ä»¶è¢«è§¦å‘ï¼Œåˆ™ä¸ä¼šåœ¨è§¦å‘loadäº‹ä»¶ã€‚

let filesList = document.getElementById('files-list')
filesList.addEventListener('change', (event) => {
  let info = '',
      output = document.getElementById('output'),
      progress = document.getElementById('progress'),
      files = event.target.files,
      type = 'default',
      reader = new FileReader();

  if(/image/.test(files[0].type)) {
    reader.readAsDataURL(files[0])
    type = 'image';
  } else {
    reader.readAsText(files[0])
    type = 'text'
  }

  reader.onerror = function() {
    output.innerHTML = `Could not read file, error code is ${render.error.code}`
  }

  reader.onprogress = function(event) {
    debugger
    if(event.lengthComputable) {
      progress.innerHTML = `${event.loaded}/${event.total}`
    }
  }

  reader.onload = function() {
    let html = '';

    switch(type) {
      case 'image':
        html = `<img src="${reader.result}"/>`
        break;

      case 'text':
        html = reader.result;
        break;
    }

    output.innerHTML = html;
  }
})


20.4.3 FileReaderSync ç±»å‹

FileReaderSyncç±»å‹å°±æ˜¯FileReaderçš„åŒæ­¥ç‰ˆæœ¬ã€‚è¿™ä¸ªç±»å‹æ‹¥æœ‰ä¸FileReaderç›¸åŒçš„æ–¹æ³•ï¼Œåªæœ‰åœ¨è¿™ä¸ªæ–‡ä»¶
éƒ½åŠ è½½åˆ°å†…å­˜ä¹‹åæ‰ä¼šç»§ç»­æ‰§è¡Œã€‚FileReaderSyncåªæœ‰åœ¨å·¥ä½œçº¿ç¨‹ä¸­å¯ä»¥ç”¨ï¼Œå› ä¸ºå¦‚æœè¯»å–æ•´ä¸ªæ–‡ä»¶è€—æ—¶å¤ªé•¿
åˆ™ä¼šå½±å“å…¨å±€ã€‚

å‡è®¾é€šè¿‡postMessage()å‘å·¥ä½œçº¿ç¨‹å‘é€äº†ä¸€ä¸ªFileå¯¹è±¡ã€‚ä»¥ä¸‹ä»£ç ä¼šè®©å·¥ä½œçº¿ç¨‹åŒæ­¥å°†æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­ï¼Œ
ç„¶åå°†æ–‡ä»¶çš„æ•°æ®URLå‘å›æ¥ã€‚

//worker.js

self.onmessage = messageEvent => {
  const syncReader = new FileReaderSync();
  console.log(syncReader)

  //è¯»å–æ–‡ä»¶æ—¶é˜»å¡å·¥ä½œçº¿ç¨‹
  const result = syncReader.readerAsDataUrl(messageEvent.data)

  //PDFæ–‡ä»¶çš„ç¤ºä¾‹å“åº”
  console.log(result) // data:application/pdf;base64,JVBERi0xLjQK...

  //æŠŠURLå‘å›å»
  self.postMessage(result)
}

20.4.4 Blobä¸éƒ¨åˆ†è¯»å–

æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦è¯»å–éƒ¨åˆ†æ–‡ä»¶è€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ã€‚ä¸ºæ­¤ï¼ŒFileå¯¹è±¡æä¾›äº†ä¸€ä¸ªåä¸ºslice()çš„æ–¹æ³•ã€‚
slice()æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šå…¶å®å­—èŠ‚å’Œè¦è¯»å–çš„å­—èŠ‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªBlobçš„ç¤ºä¾‹ï¼Œè€ŒBlobå®é™…ä¸Šæ˜¯
Fileçš„è¶…ç±»ã€‚

blobè¡¨ç¤ºäºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼ˆbinary  larget objectï¼‰ï¼Œæ˜¯jså¯¹ä¸å¯ä¿®æ”¹äºŒè¿›åˆ¶æ•°æ®çš„å°è£…ç±»å‹ã€‚åŒ…å«å­—ç¬¦ä¸²
çš„æ•°ç»„ã€ArrayBuffersã€ArrayBufferViewsï¼Œç”šè‡³å…¶ä»–Blobéƒ½å¯ä»¥ç”¨æ¥åˆ›å»ºblobã€‚Blobæ„é€ å‡½æ•°å¯ä»¥æ¥æ”¶
ä¸€ä¸ªoptionså‚æ•°ï¼Œå¹¶åœ¨å…¶ä¸­æŒ‡å®šMIMEç±»å‹ï¼š

console.log(new Blob(['foo']))
//BlobÂ {size: 3, type: ""}

console.log(new Blob(['{"a": "b"}'], {type: 'application/json'}))
//BlobÂ {size: 10, type: "application/json"}

console.log(new Blob(['<p>Foo</p>','<p>Bar</p>'], {type: 'text/html'}))
//BlobÂ {size: 20, type: "text/html"}

Blobå¯¹è±¡æœ‰ä¸€ä¸ªsizeå±æ€§å’Œtypeå±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ªslice()æ–¹æ³•ç”¨äºè¿›ä¸€æ­¥åˆ‡åˆ†æ•°æ®ã€‚å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨FileReader
ä»Blobä¸­è¯»å–æ•°æ®ã€‚ä¸‹é¢çš„ä¾‹å­åªä¼šè¯»å–æ–‡ä»¶çš„å‰32å­—èŠ‚ï¼š

let filesList = document.getElementById('files-list')
filesList.addEventListener('change', (event) => {
  let info = '',
      output = document.getElementById('output'),
      progress = document.getElementById('progress'),
      files = event.target.files,
      type = 'default',
      reader = new FileReader(),
      blob = new Blob().slice(files[0], 0, 32);
  if(blob){
    reader.onerror = function() {
      output.innerHTML = `Could not read file, error code is ${render.error.code}`
    }

    reader.onload = function() {
      output.innerHTML = reader.result;
    }

    reader.readAsText(blob);
  } else {
    console.log(`Your browser doesn't support slice().`)
  }
})


20.4.5 å¯¹è±¡URLä¸Blob

å¯¹è±¡URLæœ‰æ—¶å€™ä¹Ÿç§°ä¸ºBlob URLï¼Œæ˜¯æŒ‡å¼•ç”¨å­˜å‚¨åœ¨Fileæˆ–Blobä¸­æ•°æ®çš„URLã€‚å¯¹è±¡URLçš„ä¼˜ç‚¹æ—¶ä¸ç”¨æŠŠæ–‡ä»¶å†…å®¹
è¯»å–åˆ°javascriptä¹Ÿå¯ä»¥ä½¿ç”¨æ–‡ä»¶ã€‚åªè¦åœ¨é€‚å½“ä½ç½®æä¾›å¯¹è±¡URLå³å¯ã€‚è¦åˆ›å»ºå¯¹è±¡URLï¼Œå¯ä»¥ä½¿ç”¨window.URL.
createObjectURL()æ–¹æ³•å¹¶ä¼ å…¥Fileæˆ–Blobå¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°è¿”å›çš„å€¼æ˜¯ä¸€ä¸ªæŒ‡å‘å†…å­˜ä¸­åœ°å€çš„å­—ç¬¦ä¸²ã€‚å› ä¸ºè¿™ä¸ª
å­—ç¬¦ä¸²æ˜¯URLï¼Œæ‰€ä»¥å¯ä»¥åœ¨DOMä¸­ç›´æ¥ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä½¿ç”¨å¯¹è±¡URLåœ¨é¡µé¢ä¸­æ˜¾ç¤ºäº†ä¸€å¼ å›¾ç‰‡ï¼š

let filesList = document.getElementById('files-list')
filesList.addEventListener('change', event => {
  let info = '',
      output = document.getElementById('output'),
      progress = document.getElementById('progress'),
      files = event.target.files,
      type = 'default',
      reader = new FileReader(),
      url = window.URL.createObjectURL(files[0]);

  console.log(url)

  if(url) {
    if(/image/.test(files[0].type)) {
      output.innerHTML = `<img src=${url}/>`
    } else {
      output.innerHTML = 'Not an image.'
    }
  } else {
    output.innerHTML = "Your browser doesn't support object URLs."
  }
})

20.4.6 è¯»å–æ‹–æ”¾æ–‡ä»¶

let droptarget = document.getElementById('droptarget')

function handleEvent(event) {
  let info = '',
      output = document.getElementById('output'),
      files, i, len;
  
  event.preventDefault();

  if(event.type == 'drop') {
    files = event.dataTransfer.files;
    i = 0;
    len = files.length;

    while(i < len) {
      info += `${files[i].name} (${files[i].type}, ${files[i].size} bytes) <br>`
      i++;
    }

    output.innerHTML = info;
  }
}

droptarget.addEventListener('dragenter', handleEvent)
droptarget.addEventListener('dragover', handleEvent)
droptarget.addEventListener('drop', handleEvent)


20.5 åª’ä½“å…ƒç´ 

20.6 åŸç”Ÿæ‹–æ”¾

20.6.1 æ‹–æ”¾äº‹ä»¶

åœ¨æŸä¸ªå…ƒç´ è¢«æ‹–åŠ¨æ—¶ï¼Œä¼šï¼ˆæŒ‰é¡ºåºï¼‰è§¦å‘ä»¥ä¸‹äº‹ä»¶ï¼š
1.dragstart
2.drag
3.dragend

åœ¨æŒ‰ä½é¼ æ ‡é”®ä¸æ”¾å¹¶å¼€å§‹ç§»åŠ¨é¼ æ ‡çš„é‚£ä¸€åˆ»ï¼Œè¢«æ‹–åŠ¨å…ƒç´ ä¸Šä¼šè§¦å‘dragstartäº‹ä»¶ã€‚æ­¤æ—¶å…‰æ ‡ä¼šå˜æˆéæ”¾ç½®ç¬¦å·
è¡¨ç¤ºå…ƒç´ ä¸èƒ½æ”¾åˆ°è‡ªèº«ä¸Šã€‚æ‹–åŠ¨å¼€å§‹æ—¶ï¼Œå¯ä»¥åœ¨ondragstartäº‹ä»¶å¤„ç†ç¨‹åºä¸­é€šè¿‡jsæ‰§è¡ŒæŸäº›æ“ä½œã€‚

dragstartäº‹ä»¶è§¦å‘åï¼Œåªè¦ç›®æ ‡è¿˜è¢«æ‹–åŠ¨å°±ä¼šæŒç»­è§¦å‘dragäº‹ä»¶ã€‚è¿™ä¸ªäº‹ä»¶ç±»ä¼¼äºMousemoveï¼Œå³éšç€é¼ æ ‡
ç§»åŠ¨è€Œä¸æ–­è§¦å‘ã€‚å½“æ‹–åŠ¨åœæ­¢æ—¶ï¼ˆæŠŠå…ƒç´ æ”¾åˆ°æœ‰æ•ˆæˆ–æ— æ•ˆçš„æ”¾ç½®ç›®æ ‡ä¸Šï¼‰ï¼Œä¼šè§¦å‘dragendäº‹ä»¶

æ‰€æœ‰è¿™3ä¸ªäº‹ä»¶çš„ç›®æ ‡éƒ½æ˜¯è¢«æ‹–åŠ¨çš„å…ƒç´ ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç´ åœ¨æ‹–åŠ¨å¼€å§‹åä¸ä¼šæ”¹å˜æ‹–åŠ¨å…ƒç´ çš„å¤–è§‚ï¼Œå› æ­¤æ˜¯å¦
æ”¹å˜å¤–è§‚ç”±ä½ æ¥å†³å®šã€‚ä¸è¿‡å¤§å¤šæ•°æµè§ˆå™¨æ­¤æ—¶ä¼šåˆ›å»ºå…ƒç´ çš„ä¸€ä¸ªåŠé€æ˜å‰¯æœ¬ï¼Œå§‹ç»ˆè·Ÿéšåœ¨å…‰æ ‡ä¸‹æ–¹ã€‚

æŠŠå…ƒç´ æ‹–åŠ¨åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„æ”¾ç½®ç›®æ ‡ä¸Šæ—¶ï¼Œä¼šä¸€æ¬¡è§¦å‘ä»¥ä¸‹äº‹ä»¶ï¼š
1.dragenter
2.dragover
3.dragleaveæˆ–drop

åªè¦ä¸€æŠŠå…ƒç´ æ‹–åŠ¨åˆ°æ”¾ç½®ç›®æ ‡ä¸Šï¼Œdragenteräº‹ä»¶ï¼ˆç±»ä¼¼mouseoveräº‹ä»¶ï¼‰å°±ä¼šè§¦å‘ã€‚dragenteräº‹ä»¶è§¦å‘ä¹‹å
ä¼šç«‹å³è§¦å‘dragoveräº‹ä»¶ï¼Œå¹¶ä¸”å…ƒç´ åœ¨æ”¾ç½®ç›®æ ‡èŒƒå›´å†…è¢«æ‹–åŠ¨æœŸé—´æ­¤äº‹ä¼šæŒç»­è§¦å‘ã€‚å½“å…ƒç´ è¢«æ‹–åŠ¨æ”¾ç½®ç›®æ ‡ä¹‹å¤–
dragoveräº‹ä»¶åœæ­¢è§¦å‘ï¼Œdragleaveäº‹ä»¶è§¦å‘(ç±»ä¼¼äºmouseoutäº‹ä»¶)ã€‚å¦‚æœè¢«æ‹–åŠ¨å…ƒç´ è¢«æ”¾åˆ°äº†ç›®æ ‡ä¸Šï¼Œåˆ™ä¼š
è§¦å‘dropäº‹ä»¶è€Œä¸æ˜¯dragleaveäº‹ä»¶ã€‚è¿™äº›äº‹ä»¶çš„ç›®æ ‡æ˜¯æ”¾ç½®ç›®æ ‡å…ƒç´ ã€‚

20.6.2 è‡ªå®šä¹‰æ”¾ç½®ç›®æ ‡

20.6.3 dataTransfer å¯¹è±¡

20.6.4 dropEffect ä¸ effectAllowed

20.6.5 å¯æ‹–åŠ¨èƒ½åŠ›

//ç¦æ­¢æ‹–åŠ¨å›¾ç‰‡
<img src="smile.gif" draggable="false" alt="Smiley face" />

20.6.6 å…¶ä»–æˆå‘˜

20.7 Notifications API

ç”¨äºå‘ç”¨æˆ·æ˜¾ç¤ºé€šçŸ¥ã€‚ ç±»ä¼¼alert()å¯¹è¯æ¡†

Notifications APIåœ¨Service Workerä¸­éå¸¸æœ‰ç”¨ã€‚æ¸è¿›webåº”ç”¨ï¼ˆPWAï¼Œprogressive web applicationï¼‰
é€šè¿‡è§¦å‘é€šçŸ¥å¯ä»¥åœ¨é¡µé¢ä¸æ´»è·ƒæ—¶å‘ç”¨æˆ·æ˜¾ç¤ºæ¶ˆæ¯ï¼Œçœ‹èµ·æ¥å°±åƒåŸç”Ÿåº”ç”¨ã€‚

Notification.requestPermission()
  .then(permission => {
    console.log('user responded to permission request:', permission)
  })


new Notification('Title text!', {
  body: 'Body text',
  vibrate: true
})


20.8 Page Visibility API

åˆ¤æ–­é¡µé¢æ˜¯å¦è¢«æœ€å°åŒ–æˆ–éšè—åœ¨å…¶ä»–æ ‡ç­¾é¡µåé¢ã€‚

document.visibilityState

20.9 Streams API

Streams APIæ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªç®€å•ä½†åˆåŸºç¡€çš„é—®é¢˜è€Œç”Ÿçš„ï¼šWebåº”ç”¨å¦‚ä½•æ¶ˆè´¹æœ‰åºçš„å°ä¿¡æ¯å¿«è€Œä¸æ˜¯å¤§å—ä¿¡æ¯ï¼Ÿ

20.10 è®¡æ—¶å™¨ API

é¡µé¢æ€§èƒ½å§‹ç»ˆæ˜¯webå¼€å‘è€…å…³å¿ƒçš„è¯é¢˜ã€‚Performanceæ¥å£é€šè¿‡js APIæš´éœ²äº†æµè§ˆå™¨å†…éƒ¨çš„åº¦é‡æŒ‡æ ‡ï¼Œå…è®¸å¼€å‘è€…
ç›´æ¥è®¿é—®è¿™äº›ä¿¡æ¯å¹¶åŸºäºè¿™äº›ä¿¡æ¯å®ç°è‡ªå·±æƒ³è¦çš„åŠŸèƒ½ã€‚è¿™äº›æ¥å£æš´éœ²åœ¨window.performanceå¯¹è±¡ä¸Šã€‚æ‰€æœ‰ä¸
é¡µé¢ç›¸å…³çš„æŒ‡æ ‡ï¼ŒåŒ…æ‹¬å·²ç»å®šä¹‰å’Œå°†æ¥ä¼šå®šä¹‰çš„ï¼Œéƒ½ä¼šå­˜åœ¨äºè¿™ä¸ªå¯¹è±¡ä¸Š

Performanceæ¥å£ç”±å¤šä¸ªAPIæ„æˆï¼š
Â·High Resolution Time API
Â·Performance Timeline API
Â·Navigation Timing API
Â·User Timing API
Â·Resource Timing API
Â·Paint Timing API

20.10.1 High Resolution Time API

window.performance.now(),è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå¾®ç§’ç²¾åº¦çš„æµ®ç‚¹å€¼ã€‚

20.10.2 Performance Timeline API

Performance Timeline APIä½¿ç”¨ä¸€å¥—ç”¨äºåº¦é‡å®¢æˆ·ç«¯å»¶è¿Ÿçš„å·¥å…·æ‰©å±•äº†Performanceæ¥å£ã€‚

20.11 Web ç»„ä»¶

20.11.1 HTMLæ¨¡æ¿

<template id="foo">
  <p>I'm inside a template!</p>
</template>

1.ä½¿ç”¨DocumentFragment

åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“æ—¶ï¼Œä¸Šé¢ä¾‹å­ä¸­çš„æ–‡æœ¬ä¸ä¼šè¢«æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚å› ä¸º<template>çš„å†…å®¹ä¸å±äºæ´»åŠ¨æ–‡æ¡£ï¼Œæ‰€ä»¥
document.querySelector()ç­‰DOMæŸ¥è¯¢æ–¹æ³•ä¸ä¼šå‘ç°å…¶ä¸­çš„<p>æ ‡ç­¾ã€‚è¿™æ˜¯å› ä¸º<p>å­˜åœ¨äºä¸€ä¸ªåŒ…å«åœ¨html
æ¨¡æ¿ä¸­çš„DocumentFragmentèŠ‚ç‚¹å†…ã€‚

åœ¨æµè§ˆå™¨ä¸­é€šè¿‡å¼€å‘è€…å·¥å…·æ£€æŸ¥ç½‘é¡µå†…å®¹æ—¶ï¼Œå¯ä»¥çœ‹åˆ°<template>ä¸­çš„DocumentFragment:

<template>
  #document-fragment
    <p>I'm inside a template!</p>
</template>

é€šè¿‡<template>å…ƒç´ çš„contentå±æ€§å¯ä»¥å–å¾—è¿™ä¸ªDocumentFragmentçš„å¼•ç”¨ï¼š
console.log(document.querySelector('#foo').content)
//#document-fragment

æ­¤æ—¶çš„DocumentFragmentå°±åƒä¸€ä¸ªå¯¹åº”å­æ ‘çš„æœ€å°åŒ–documentå¯¹è±¡ã€‚æ¢å¥è¯è¯´ï¼ŒDocumentFragmentä¸Šçš„
DOMåŒ¹é…æ–¹æ³•å¯ä»¥æŸ¥è¯¢å…¶å­æ ‘ä¸­çš„èŠ‚ç‚¹

const fragment = document.querySelector('#foo').content
console.log(fragment.querySelector('p'))

documentFragmentä¹Ÿæ˜¯æ‰¹é‡æƒ³HTMLä¸­æ·»åŠ å…ƒç´ çš„é«˜æ•ˆå·¥å…·ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³ä»¥æœ€å¼€çš„æ–¹å¼ç»™æŸä¸ªHTMLå…ƒç´ æ·»
å¤šä¸ªå­å…ƒç´ ã€‚å¦‚æœè¿ç»­è°ƒç”¨document.appendChild(),åˆ™ä¸ä»…è´¹äº‹ï¼Œè¿˜ä¼šå¯¼è‡´å¤šæ¬¡å¸ƒå±€é‡æ’ã€‚è€Œä½¿ç”¨
DocumentFragmentå¯ä»¥ä¸€æ¬¡æ€§æ·»åŠ å¤šæœ‰å­èŠ‚ç‚¹ï¼Œæœ€å¤šåªä¼šæœ‰ä¸€æ¬¡å¸ƒå±€é‡æ’ï¼š

const fragment = new DocumentFragment();
const foo = document.querySelector('#foo')

fragment.appendChild(document.createElement('p'))
fragment.appendChild(document.createElement('p'))
fragment.appendChild(document.createElement('p'))

console.log(fragment.children.length)
foo.appendChild(fragment)
console.log(fragment.children.length)
console.log(document.body.innerHTML)

2. ä½¿ç”¨<template>æ ‡ç­¾

æ³¨æ„ï¼Œåœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼ŒDocumentFragmentçš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½é«˜æ•ˆåœ°è½¬ç§»åˆ°äº†fooå…ƒç´ ä¸Šï¼Œè½¬ç§»ä¹‹åDocumentFragment
å˜ç©ºäº†ï¼ŒåŒæ ·çš„è¿‡ç¨‹ä¹Ÿå¯ä»¥ä½¿ç”¨<template>æ ‡ç­¾é‡ç°ï¼š

const fooElement = document.querySelector('#foo')
const barTemplate = document.querySelector('#bar')
const barFragment = barTemplate.content;

console.log(document.body.innerHTML)

fooElement.appendChild(barFragment)
console.log(document.body.innerHTML)

å¦‚æœæƒ³è¦å¤åˆ¶æ¨¡æ¿ï¼Œå¯ä»¥ä½¿ç”¨ImportNode()æ–¹æ³•å…‹éš†DocumentFragment;

const fooElement = document.querySelector('#foo')
const barTemplate = document.querySelector('#bar')
const barFragment = barTemplate.content;
console.log(document.body.innerHTML)

fooElement.appendChild(document.importNode(barFragment, true))
console.log(document.body.innerHTML)

3.æ¨¡æ¿è„šæœ¬

è„šæœ¬æ‰§è¡Œå¯ä»¥æ¨è¿Ÿåˆ°å°†DocumentFragmentçš„å†…å®¹å®é™…æ·»åŠ åˆ°DOMæ ‘ã€‚

<div id="foo"></div>
<template id="bar">
  <script>console.log('Template script executed')</script>
</template>

const fooElement = document.querySelector('#foo')
const barTemplate = document.querySelector('#bar')
const barFragment = barTemplate.content;

console.log('About to add template')
fooElement.appendChild(barFragment)
console.log('Added template')

20.11.2 å½±å­DOM

æ¦‚å¿µä¸Šè®²ï¼Œå½±å­DOMï¼ˆshadow DOMï¼‰webç»„ä»¶ç›¸å½“ç›´è§‚ï¼Œé€šè¿‡å®ƒå¯ä»¥å°†ä¸€ä¸ªå®Œæ•´çš„DOMæ ‘ä½œä¸ºèŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶DOMæ ‘ã€‚
è¿™ä¹Ÿå¯ä»¥å®ç°domå°è£…ï¼Œæ„å‘³ç€cssæ ·å¼å’Œcssé€‰æ‹©ç¬¦å¯ä»¥é™åˆ¶åœ¨å½±å­DOMå­æ ‘è€Œä¸æ˜¯æ•´ä¸ªé¡¶çº§DOMæ ‘ä¸­ã€‚

å½±å­DOMä¸HTMLæ¨¡æ¿å¾ˆç›¸ä¼¼ï¼Œå› ä¸ºiä»–ä»¬éƒ½æ˜¯ç±»ä¼¼documentçš„ç»“æ„ï¼Œå¹¶å…è®¸ä¸é¡¶çº§DOMæœ‰ä¸€å®šç¨‹åº¦çš„åˆ†ç¦»ã€‚ä¸è¿‡ï¼Œ
å½±å­DOMä¸htmlæ¨¡æ¿è¿˜æ—¶æœ‰åŒºåˆ«çš„ï¼Œä¸»è¦è¡¨ç°åœ¨å½±å­DOMçš„å†…å®¹ä¼šå®é™…æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼Œè€ŒHTMLæ¨¡æ¿çš„å†…å®¹ä¸ä¼šã€‚

1.ç†è§£å½±å­DOM

2.åˆ›å»ºå½±å­DOM

è€ƒè™‘åˆ°å®‰å…¨åŠé¿å…å½±å­DOMå†²çªï¼Œå¹¶æœªæ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥åŒ…å«å½±å­DOMã€‚å°è¯•ç»™æ— æ•ˆå…ƒç´ æˆ–å·²æœ‰äº†å½±å­DOMçš„å…ƒç´ 
æ·»åŠ å½±å­DOMä¼šå¯¼è‡´æŠ›å‡ºé”™è¯¯ã€‚

ä»¥ä¸‹æ˜¯å¯ä»¥å®¹çº³å½±å­DOMçš„å…ƒç´ 

Â·ä»å’Œä»¥æœ‰æ•ˆåç§°åœºæ™¯çš„è‡ªå®šä¹‰å…ƒç´ 
Â·<article>
Â·<aside>
Â·<blockquote>
Â·<body>
Â·<div>
Â·<footer>
Â·<h1>
Â·<h2>
Â·<h3>
Â·<h4>
Â·<h6>
Â·<header>
Â·<main>
Â·<nav>
Â·<p>
Â·<section>
Â·<span>
å½±å­DOMæ˜¯é€šè¿‡attachShadow()æ–¹æ³•åˆ›å»ºå¹¶æ·»åŠ ç»™æœ‰æ•ˆHTMLå…ƒç´ çš„ã€‚
